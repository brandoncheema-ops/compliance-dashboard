<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NF6 Capital ‚Äî Compliance Dashboard</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

  :root {
    --bg: #f5f7fa;
    --card: #ffffff;
    --border: #e2e8f0;
    --text: #1a202c;
    --text-secondary: #64748b;
    --accent: #2563eb;
    --accent-light: #eff6ff;
    --green: #16a34a;
    --green-bg: #f0fdf4;
    --yellow: #ca8a04;
    --yellow-bg: #fefce8;
    --red: #dc2626;
    --red-bg: #fef2f2;
    --orange: #ea580c;
    --orange-bg: #fff7ed;
    --purple: #7c3aed;
    --purple-bg: #f5f3ff;
    --gray: #64748b;
    --gray-bg: #f8fafc;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.5;
  }

  /* NAV */
  nav {
    background: #0f172a;
    color: #fff;
    padding: 0 2rem;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: sticky;
    top: 0;
    z-index: 100;
  }
  nav .brand { font-weight: 700; font-size: 1.15rem; letter-spacing: -.02em; }
  nav .brand span { color: #60a5fa; }
  nav .nav-links { display: flex; gap: 1.5rem; }
  nav .nav-links a { color: #94a3b8; text-decoration: none; font-size: .875rem; font-weight: 500; transition: color .2s; }
  nav .nav-links a:hover, nav .nav-links a.active { color: #fff; }
  .today-badge { background: #1e3a5f; color: #93c5fd; font-size: .75rem; padding: 4px 10px; border-radius: 6px; font-weight: 500; }

  /* HEADER */
  .page-header {
    padding: 2rem 2rem 0;
    max-width: 1400px;
    margin: 0 auto;
  }
  .page-header h1 { font-size: 1.75rem; font-weight: 700; letter-spacing: -.03em; }
  .page-header p { color: var(--text-secondary); margin-top: .25rem; font-size: .925rem; }

  /* STATS ROW */
  .stats-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    padding: 1.5rem 2rem;
    max-width: 1400px;
    margin: 0 auto;
  }
  .stat-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 1.25rem 1.5rem;
    display: flex;
    flex-direction: column;
    gap: .25rem;
  }
  .stat-card .label { font-size: .8rem; text-transform: uppercase; letter-spacing: .05em; color: var(--text-secondary); font-weight: 600; }
  .stat-card .value { font-size: 1.75rem; font-weight: 700; }
  .stat-card .sub { font-size: .8rem; color: var(--text-secondary); }
  .stat-card.danger .value { color: var(--red); }
  .stat-card.warning .value { color: var(--orange); }
  .stat-card.success .value { color: var(--green); }
  .stat-card.info .value { color: var(--accent); }

  /* REMINDER BANNER */
  .reminder-banner {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem;
  }
  .reminder-box {
    background: linear-gradient(135deg, #1e3a5f 0%, #0f172a 100%);
    border-radius: 12px;
    padding: 1.25rem 1.5rem;
    color: #fff;
    display: flex;
    align-items: center;
    gap: 1rem;
  }
  .reminder-box .icon { font-size: 1.5rem; }
  .reminder-box .content { flex: 1; }
  .reminder-box .content strong { display: block; font-size: .95rem; }
  .reminder-box .content span { font-size: .825rem; color: #94a3b8; }

  /* CONTROLS */
  .controls {
    display: flex;
    gap: .75rem;
    padding: 1.25rem 2rem;
    max-width: 1400px;
    margin: 0 auto;
    flex-wrap: wrap;
    align-items: center;
  }
  .search-box {
    flex: 1;
    min-width: 240px;
    position: relative;
  }
  .search-box input {
    width: 100%;
    padding: .625rem 1rem .625rem 2.5rem;
    border: 1px solid var(--border);
    border-radius: 8px;
    font-size: .875rem;
    font-family: inherit;
    background: var(--card);
    outline: none;
    transition: border-color .2s;
  }
  .search-box input:focus { border-color: var(--accent); }
  .search-box::before {
    content: 'üîç';
    position: absolute;
    left: .75rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: .85rem;
    pointer-events: none;
  }
  .filter-group { display: flex; gap: .35rem; flex-wrap: wrap; }
  .filter-btn {
    padding: .5rem 1rem;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--card);
    font-size: .8rem;
    font-family: inherit;
    font-weight: 500;
    cursor: pointer;
    transition: all .2s;
    color: var(--text-secondary);
  }
  .filter-btn:hover { border-color: var(--accent); color: var(--accent); }
  .filter-btn.active { background: var(--accent); color: #fff; border-color: var(--accent); }

  .select-filter {
    padding: .5rem .75rem;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--card);
    font-size: .8rem;
    font-family: inherit;
    font-weight: 500;
    cursor: pointer;
    color: var(--text-secondary);
    outline: none;
  }

  /* TABLE */
  .table-wrapper {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem 2rem;
  }
  .table-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
  }
  .table-card table {
    width: 100%;
    border-collapse: collapse;
    font-size: .85rem;
  }
  .table-card thead th {
    background: #f8fafc;
    padding: .75rem 1rem;
    text-align: left;
    font-weight: 600;
    font-size: .75rem;
    text-transform: uppercase;
    letter-spacing: .04em;
    color: var(--text-secondary);
    border-bottom: 1px solid var(--border);
    white-space: nowrap;
    cursor: pointer;
    user-select: none;
  }
  .table-card thead th:hover { color: var(--accent); }
  .table-card tbody tr { border-bottom: 1px solid #f1f5f9; transition: background .15s; }
  .table-card tbody tr:hover { background: #f8fafc; }
  .table-card tbody td { padding: .75rem 1rem; vertical-align: top; }

  /* BADGES */
  .badge {
    display: inline-block;
    padding: 2px 10px;
    border-radius: 9999px;
    font-size: .72rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: .03em;
    white-space: nowrap;
  }
  .badge-green { background: var(--green-bg); color: var(--green); }
  .badge-yellow { background: var(--yellow-bg); color: var(--yellow); }
  .badge-red { background: var(--red-bg); color: var(--red); }
  .badge-orange { background: var(--orange-bg); color: var(--orange); }
  .badge-purple { background: var(--purple-bg); color: var(--purple); }
  .badge-gray { background: var(--gray-bg); color: var(--gray); }
  .badge-blue { background: var(--accent-light); color: var(--accent); }

  .reminder-tag {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 2px 8px;
    border-radius: 6px;
    font-size: .7rem;
    font-weight: 600;
    margin-top: 4px;
  }
  .reminder-tag.r7 { background: #fef2f2; color: #dc2626; }
  .reminder-tag.r14 { background: #fff7ed; color: #ea580c; }
  .reminder-tag.r30 { background: #fefce8; color: #ca8a04; }

  .person {
    display: inline-block;
    padding: 2px 8px;
    background: #f1f5f9;
    border-radius: 6px;
    font-size: .78rem;
    font-weight: 500;
    color: #475569;
  }

  .location-flag { margin-right: 4px; }

  .obligation-text { max-width: 300px; line-height: 1.4; }
  .obligation-text .main { font-weight: 500; }
  .obligation-text .entity { color: var(--text-secondary); font-size: .78rem; }

  /* REMINDERS SECTION */
  .reminders-section {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 2rem 2rem;
  }
  .section-title {
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: .5rem;
  }
  .reminder-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: .75rem;
  }
  .reminder-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 1rem 1.25rem;
    display: flex;
    gap: 1rem;
    align-items: flex-start;
    transition: box-shadow .2s;
  }
  .reminder-card:hover { box-shadow: 0 2px 8px rgba(0,0,0,.06); }
  .reminder-card .urgency-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    margin-top: 6px;
    flex-shrink: 0;
  }
  .urgency-dot.critical { background: var(--red); }
  .urgency-dot.warning { background: var(--orange); }
  .urgency-dot.notice { background: var(--yellow); }
  .reminder-card .rc-content { flex: 1; }
  .reminder-card .rc-title { font-weight: 600; font-size: .875rem; }
  .reminder-card .rc-meta { font-size: .78rem; color: var(--text-secondary); margin-top: 2px; }
  .reminder-card .rc-due { font-size: .78rem; font-weight: 600; margin-top: 4px; }

  .email-preview {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 1.25rem 1.5rem;
    margin-top: 1rem;
  }
  .email-preview h4 { font-size: .85rem; margin-bottom: .5rem; }
  .email-preview .email-field { font-size: .8rem; color: var(--text-secondary); margin-bottom: .25rem; }
  .email-preview .email-field strong { color: var(--text); }
  .email-preview .email-body { font-size: .82rem; margin-top: .75rem; padding: .75rem; background: #f8fafc; border-radius: 8px; line-height: 1.6; }

  .no-items {
    text-align: center;
    padding: 3rem;
    color: var(--text-secondary);
    font-size: .9rem;
  }

  /* RESPONSIVE */
  @media (max-width: 768px) {
    .controls { flex-direction: column; }
    .search-box { min-width: 100%; }
    .table-card { overflow-x: auto; }
    .stats-row { grid-template-columns: repeat(2, 1fr); }
    .reminder-cards { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<nav>
  <div class="brand">NF6 <span>Capital</span></div>
  <div class="nav-links">
    <a href="#">Home</a>
    <a href="#" class="active">Dashboard</a>
    <a href="#">Calendar</a>
  </div>
  <div class="today-badge" id="todayBadge"></div>
</nav>

<div class="page-header">
  <h1>Compliance Dashboard</h1>
  <p>Track obligations, due dates, and upcoming reminders across all entities and locations.</p>
</div>

<div class="stats-row" id="statsRow"></div>

<div class="reminder-banner" id="reminderBanner"></div>

<div class="controls">
  <div class="search-box">
    <input type="text" id="searchInput" placeholder="Search obligations, entities, people‚Ä¶">
  </div>
  <div class="filter-group" id="statusFilters">
    <button class="filter-btn active" data-filter="all">All</button>
    <button class="filter-btn" data-filter="overdue">Overdue</button>
    <button class="filter-btn" data-filter="due-7">Due ‚â§ 7 days</button>
    <button class="filter-btn" data-filter="due-14">Due ‚â§ 14 days</button>
    <button class="filter-btn" data-filter="due-30">Due ‚â§ 30 days</button>
    <button class="filter-btn" data-filter="up-to-date">Up to Date</button>
    <button class="filter-btn" data-filter="not-started">Not Started</button>
  </div>
  <select class="select-filter" id="locationFilter">
    <option value="all">All Locations</option>
  </select>
  <select class="select-filter" id="entityFilter">
    <option value="all">All Entities</option>
  </select>
  <select class="select-filter" id="personFilter">
    <option value="all">All People</option>
  </select>
</div>

<div class="table-wrapper">
  <div class="table-card">
    <table>
      <thead>
        <tr>
          <th data-sort="status">Status</th>
          <th data-sort="obligation">Obligation</th>
          <th data-sort="category">Category</th>
          <th data-sort="location">Location</th>
          <th data-sort="entity">Entity</th>
          <th data-sort="person">Responsible</th>
          <th data-sort="frequency">Freq</th>
          <th data-sort="nextDue">Next Due</th>
          <th data-sort="cost">Cost</th>
          <th>Reminder</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
    <div class="no-items" id="noItems" style="display:none;">No compliance items match your filters.</div>
  </div>
</div>

<div class="reminders-section">
  <div class="section-title">üìß Upcoming Email Reminders <span style="font-weight:400;font-size:.8rem;color:var(--text-secondary);">(to brandon.cheema@nf6capital.com)</span></div>
  <div class="reminder-cards" id="reminderCards"></div>
  <div class="email-preview" id="emailPreview"></div>
</div>

<script>
// ‚îÄ‚îÄ RAW DATA ‚îÄ‚îÄ
const RAW_DATA = [
  {status:"Recurring - Up to date",type:"Property",category:"Property Taxes",location:"United States",entity:"NF Texas",obligation:"Pay property taxes by 1/31 each year ‚Äî Harris County",person:"Amanda/Brandon",frequency:"Yearly",dateDone:"1/15/2026",dateToDo:"1/15/2027",nextDue:"1/31/2027",description:"Texas taxes SOP",cost:"",link:"https://myharriscountytax.com/"},
  {status:"Recurring - Up to date",type:"Property",category:"Property Taxes",location:"United States",entity:"NF Texas",obligation:"Pay property taxes by 1/31 each year ‚Äî Spring Branch ISD",person:"Amanda/Brandon",frequency:"Yearly",dateDone:"1/15/2026",dateToDo:"1/15/2027",nextDue:"1/31/2027",description:"Texas taxes SOP",cost:"",link:"https://sbisd.propertytaxpayments.net/search"},
  {status:"Recurring - Up to date",type:"Donation",category:"Act 22 requirement",location:"Puerto Rico",entity:"MN Personal",obligation:"Make a yearly donation in PR",person:"Amanda/Brandon",frequency:"Yearly",dateDone:"1/8/2026",dateToDo:"1/5/2027",nextDue:"12/31/2027",description:"Donation SOP",cost:"$5,000.00",link:""},
  {status:"Recurring - Up to date",type:"529 Gift",category:"529 Gift",location:"United States",entity:"MN Personal",obligation:"Make yearly contribution to Dr. Mike's nieces and nephews",person:"Amanda/Brandon",frequency:"Yearly",dateDone:"12/29/2025",dateToDo:"12/1/2026",nextDue:"12/31/2026",description:"529 SOP",cost:"$114,000.00",link:"https://www.ugift529.com/"},
  {status:"Recurring - Up to date",type:"Car",category:"Tesla",location:"Puerto Rico",entity:"MN Personal",obligation:"Tesla Car Insurance",person:"Tim",frequency:"Yearly",dateDone:"10/6/2025",dateToDo:"9/1/2026",nextDue:"10/6/2026",description:"",cost:"",link:""},
  {status:"Recurring - Up to date",type:"Car",category:"Tesla",location:"Puerto Rico",entity:"MN Personal",obligation:"Tesla Registration",person:"Tim",frequency:"Yearly",dateDone:"",dateToDo:"",nextDue:"",description:"",cost:"",link:""},
  {status:"Recurring - Up to date",type:"Car",category:"Tahoe",location:"Colombia",entity:"NF MDE CO",obligation:"Tahoe insurance SURA",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"12/23/2025",dateToDo:"12/23/2026",nextDue:"12/28/2026",description:"",cost:"$3,842.00",link:""},
  {status:"Recurring - Up to date",type:"Car",category:"Tahoe",location:"Colombia",entity:"NF MDE CO",obligation:"Tahoe vehicle tax ‚Äî Gobernaci√≥n de Antioquia",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"1/15/2026",dateToDo:"1/15/2027",nextDue:"1/28/2027",description:"Pay through Gobernaci√≥n de Ant. website",cost:"",link:"https://www.vehiculosantioquia.com.co/"},
  {status:"Recurring - Up to date",type:"Car",category:"Tahoe",location:"Colombia",entity:"NF MDE CO",obligation:"Tahoe ‚Äî SOAT renewal",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"12/25/2025",dateToDo:"12/25/2026",nextDue:"12/25/2026",description:"Buy a new SOAT through Rappi or another website",cost:"",link:""},
  {status:"Recurring - Due Soon",type:"Insurance",category:"Dorado Insurance",location:"Puerto Rico",entity:"MN Personal",obligation:"Renew Insurance ‚Äî hazard policy meets Oriental's requirements",person:"Tim",frequency:"Yearly",dateDone:"1/23/2026",dateToDo:"4/14/2026",nextDue:"5/14/2026",description:"MAPFRE Insurance",cost:"$2,667.00",link:""},
  {status:"Recurring - Up to date",type:"Insurance",category:"Dorado Insurance",location:"Puerto Rico",entity:"MN Personal",obligation:"Obtain Master Policy from Dorado ‚Äî due to Oriental 60 days before expiry",person:"Tim",frequency:"Yearly",dateDone:"11/14/2025",dateToDo:"8/1/2026",nextDue:"11/14/2026",description:"",cost:"",link:""},
  {status:"Recurring - Up to date",type:"Insurance",category:"Dorado Insurance",location:"Puerto Rico",entity:"MN Personal",obligation:"Commercial insurance",person:"Tim",frequency:"Yearly",dateDone:"2/17/2026",dateToDo:"1/16/2027",nextDue:"2/16/2027",description:"",cost:"$1,650.00",link:""},
  {status:"Recurring - Due Soon",type:"Property",category:"Maintenance",location:"Puerto Rico",entity:"MN Personal",obligation:"AC maintenance quarterly",person:"Amanda/Brandon",frequency:"Quarterly",dateDone:"2/3/2026",dateToDo:"5/1/2026",nextDue:"5/1/2026",description:"AC Maintenance Schedule",cost:"$295.00",link:""},
  {status:"Recurring - Due Soon",type:"Property",category:"Maintenance",location:"France",entity:"MN Personal",obligation:"AC maintenance bi-yearly",person:"Amanda/Brandon",frequency:"Bi-yearly",dateDone:"11/24/2025",dateToDo:"5/1/2026",nextDue:"5/24/2026",description:"AC Maintenance Schedule",cost:"$938.20",link:""},
  {status:"Recurring - Due Soon",type:"Property",category:"Maintenance",location:"Puerto Rico",entity:"MN Personal",obligation:"Exterminator monthly service",person:"Brandon",frequency:"Monthly",dateDone:"2/4/2026",dateToDo:"",nextDue:"3/2/2026",description:"",cost:"",link:""},
  {status:"Recurring - Up to date",type:"Property",category:"Maintenance",location:"Puerto Rico",entity:"MN Personal",obligation:"Golf cart maintenance at Dorado",person:"Tim",frequency:"Monthly",dateDone:"",dateToDo:"",nextDue:"",description:"",cost:"",link:""},
  {status:"Recurring - Up to date",type:"MN Personal",category:"Passport",location:"United States",entity:"MN Personal",obligation:"Renew passport",person:"Mike/Amanda/Brandon",frequency:"Other",dateDone:"",dateToDo:"",nextDue:"3/25/2034",description:"",cost:"",link:""},
  {status:"Recurring - Up to date",type:"MN Personal",category:"Medical License",location:"Puerto Rico",entity:"MN Personal",obligation:"Renew Dr. Mike's medical license",person:"Mike",frequency:"Other",dateDone:"8/4/2024",dateToDo:"6/1/2027",nextDue:"8/4/2027",description:"",cost:"",link:""},
  {status:"Recurring - Up to date",type:"MN Personal",category:"PR Drivers License",location:"Puerto Rico",entity:"MN Personal",obligation:"Renew Dr. Mike's PR Drivers License",person:"Mike/Amanda/Brandon",frequency:"Other",dateDone:"6/20/2025",dateToDo:"5/1/2033",nextDue:"8/4/2033",description:"",cost:"",link:""},
  {status:"Recurring - Up to date",type:"Business expense",category:"Keeper Security",location:"United States",entity:"TLMND",obligation:"Renew Keeper Security every 3 years",person:"Amanda/Brandon",frequency:"Other",dateDone:"6/24/2025",dateToDo:"5/1/2028",nextDue:"6/25/2028",description:"",cost:"",link:""},
  {status:"Recurring - Up to date",type:"Entity",category:"Mailbox",location:"France",entity:"Paris Thacko",obligation:"Mailbox subscription ‚Äî Paris (253 rue Saint Honor√©)",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"7/16/2025",dateToDo:"7/1/2026",nextDue:"7/1/2026",description:"Pay through Banco Santander portal via transfer",cost:"$1,261.00",link:""},
  {status:"Recurring - Up to date",type:"Property",category:"House Insurance",location:"France",entity:"Paris Thacko",obligation:"House Insurance of 5 Quai Montebello ‚Äî AXXA",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"12/5/2025",dateToDo:"12/1/2025",nextDue:"12/1/2026",description:"Pay through Banco Santander portal via transfer",cost:"$528.00",link:""},
  {status:"Recurring - Up to date",type:"Property",category:"Property Taxes",location:"France",entity:"Paris Thacko",obligation:"Tax Fonciere ‚Äî RE Tax",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"10/27/2025",dateToDo:"10/1/2025",nextDue:"10/1/2026",description:"Automatic debit set up",cost:"$2,428.00",link:""},
  {status:"Recurring - Up to date",type:"Property",category:"Property Taxes",location:"France",entity:"Paris Thacko",obligation:"Vacant Housing Tax",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"12/30/2026",dateToDo:"10/31/2025",nextDue:"12/30/2026",description:"Automatic debit set up",cost:"$5,777.00",link:""},
  {status:"Recurring - Up to date",type:"Entity",category:"Entity Taxes",location:"France",entity:"Paris Thacko",obligation:"Paris Thacko corporate tax",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"10/1/2025",dateToDo:"10/1/2025",nextDue:"10/1/2026",description:"Automatic debit set up",cost:"",link:""},
  {status:"Recurring - Up to date",type:"Property",category:"HOA",location:"France",entity:"Paris Thacko",obligation:"5 Quai Montebello HOA ‚Äî Syndic quarterly",person:"Manuela Vallejo",frequency:"Quarterly",dateDone:"12/28/2025",dateToDo:"4/1/2026",nextDue:"4/1/2026",description:"Pay through Banco Santander portal via transfer",cost:"$1,296.00",link:""},
  {status:"Recurring - Up to date",type:"Entity",category:"Accountant fees",location:"France",entity:"Paris Thacko",obligation:"Fees to France accountants Groupe Prieur (Dec & Mar)",person:"Manuela Vallejo",frequency:"Bi-yearly",dateDone:"12/9/2025",dateToDo:"3/10/2026",nextDue:"3/10/2026",description:"Pay through Banco Santander portal via transfer",cost:"$1,860.00",link:""},
  {status:"Recurring - Up to date",type:"Entity",category:"Tax returns filing",location:"France",entity:"Paris Thacko",obligation:"Tax returns filing ‚Äî previous accounting year w/ Groupe Prieur",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"4/1/2025",dateToDo:"4/1/2025",nextDue:"4/1/2026",description:"",cost:"",link:""},
  {status:"Recurring - Up to date",type:"MN Personal",category:"Subscription",location:"United States",entity:"MN Personal",obligation:"United Club membership",person:"Mike/Amanda/Brandon",frequency:"Yearly",dateDone:"9/30/2025",dateToDo:"",nextDue:"9/30/2026",description:"Auto renew on TLMND business card",cost:"",link:""},
  {status:"Recurring - Up to date",type:"MN Personal",category:"Subscription",location:"United States",entity:"MN Personal",obligation:"AARP Membership renewal (every 5 years)",person:"Amanda/Brandon",frequency:"Other",dateDone:"2/3/2026",dateToDo:"2/1/2031",nextDue:"2/3/2031",description:"Go to website and click renew",cost:"$79.00",link:"https://secure.aarp.org/"},
  {status:"Recurring - Up to date",type:"MN Personal",category:"Health Insurance",location:"United States",entity:"MN Personal",obligation:"Renew Mike's Health Insurance ‚Äî GeoBlue",person:"Tim",frequency:"Yearly",dateDone:"10/15/2025",dateToDo:"9/1/2026",nextDue:"10/14/2026",description:"",cost:"$762/month",link:""},
  {status:"Not started",type:"Property",category:"Real Estate Tax",location:"Colombia",entity:"NF MDE CO",obligation:"Quebrada Arriba RE Tax (Predial)",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"2/10/2025",dateToDo:"2/28/2026",nextDue:"2/28/2027",description:"Pay RE tax through Alcald√≠a de Med. portal",cost:"Variable",link:"https://www.medellin.gov.co"},
  {status:"Recurring - Up to date",type:"Property",category:"Real Estate Tax",location:"Colombia",entity:"NF MDE CO",obligation:"Cintur√≥n Verde RE Tax (Predial)",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"2/10/2026",dateToDo:"2/10/2027",nextDue:"2/10/2027",description:"Pay RE tax through Alcald√≠a de Med. portal",cost:"Variable",link:"https://www.medellin.gov.co"},
  {status:"Recurring - Up to date",type:"Property",category:"Real Estate Tax",location:"Colombia",entity:"NF MDE CO",obligation:"Provincia Lot RE Tax (Predial)",person:"Manuela Vallejo",frequency:"Yearly",dateDone:"2/10/2026",dateToDo:"2/10/2027",nextDue:"",description:"Pay RE tax through Alcald√≠a de Med. portal",cost:"Variable",link:"https://www.medellin.gov.co"},
  {status:"Recurring - Up to date",type:"Insurance",category:"Life Insurance",location:"United States",entity:"MN Personal",obligation:"Renew Mike's life insurance ‚Äî Lincoln Financial",person:"Tim",frequency:"Yearly",dateDone:"1/7/2026",dateToDo:"1/1/2027",nextDue:"1/7/2027",description:"",cost:"$1,609.58",link:"https://www.lincolnfinancial.com/secure/login"}
];

// ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ
const TODAY = new Date();
TODAY.setHours(0,0,0,0);

function parseDate(str) {
  if (!str) return null;
  const parts = str.split('/');
  if (parts.length !== 3) return null;
  return new Date(+parts[2], +parts[0]-1, +parts[1]);
}

function daysUntil(dateStr) {
  const d = parseDate(dateStr);
  if (!d) return Infinity;
  return Math.ceil((d - TODAY) / (1000*60*60*24));
}

function formatDate(dateStr) {
  const d = parseDate(dateStr);
  if (!d) return '‚Äî';
  return d.toLocaleDateString('en-US', { month:'short', day:'numeric', year:'numeric' });
}

function locationFlag(loc) {
  const map = { 'United States':'üá∫üá∏', 'Puerto Rico':'üáµüá∑', 'Colombia':'üá®üá¥', 'France':'üá´üá∑' };
  return map[loc] || 'üåç';
}

// ‚îÄ‚îÄ ENRICH DATA ‚îÄ‚îÄ
const items = RAW_DATA.map(d => {
  const days = daysUntil(d.nextDue);
  let urgency = 'none';
  if (days < 0) urgency = 'overdue';
  else if (days <= 7) urgency = 'critical';
  else if (days <= 14) urgency = 'warning';
  else if (days <= 30) urgency = 'notice';
  return { ...d, _days: days, _urgency: urgency };
});

// ‚îÄ‚îÄ STATS ‚îÄ‚îÄ
function renderStats() {
  const total = items.length;
  const overdue = items.filter(i => i._urgency === 'overdue').length;
  const dueSoon = items.filter(i => ['critical','warning','notice'].includes(i._urgency)).length;
  const upToDate = items.filter(i => i.status.includes('Up to date') && i._urgency === 'none').length;
  const notStarted = items.filter(i => i.status === 'Not started').length;

  document.getElementById('statsRow').innerHTML = `
    <div class="stat-card info"><div class="label">Total Items</div><div class="value">${total}</div><div class="sub">Across all entities</div></div>
    <div class="stat-card danger"><div class="label">Overdue</div><div class="value">${overdue}</div><div class="sub">Past due date</div></div>
    <div class="stat-card warning"><div class="label">Due Soon</div><div class="value">${dueSoon}</div><div class="sub">Within 30 days</div></div>
    <div class="stat-card success"><div class="label">Up to Date</div><div class="value">${upToDate}</div><div class="sub">No action needed</div></div>
    <div class="stat-card"><div class="label">Not Started</div><div class="value">${notStarted}</div><div class="sub">Needs attention</div></div>
  `;
}

// ‚îÄ‚îÄ REMINDER BANNER ‚îÄ‚îÄ
function renderBanner() {
  const urgent = items.filter(i => i._days >= 0 && i._days <= 7);
  if (!urgent.length) { document.getElementById('reminderBanner').innerHTML = ''; return; }
  document.getElementById('reminderBanner').innerHTML = `
    <div class="reminder-box">
      <div class="icon">‚ö†Ô∏è</div>
      <div class="content">
        <strong>${urgent.length} item${urgent.length>1?'s':''} due within 7 days</strong>
        <span>${urgent.map(i => i.obligation.substring(0,40)).join(' ¬∑ ')}</span>
      </div>
    </div>
  `;
}

// ‚îÄ‚îÄ POPULATE FILTERS ‚îÄ‚îÄ
function populateDropdowns() {
  const locs = [...new Set(items.map(i => i.location))].sort();
  const ents = [...new Set(items.map(i => i.entity))].sort();
  const ppl = [...new Set(items.flatMap(i => i.person.split('/')))].sort();

  const locSel = document.getElementById('locationFilter');
  locs.forEach(l => { const o = document.createElement('option'); o.value=l; o.textContent=`${locationFlag(l)} ${l}`; locSel.appendChild(o); });

  const entSel = document.getElementById('entityFilter');
  ents.forEach(e => { const o = document.createElement('option'); o.value=e; o.textContent=e; entSel.appendChild(o); });

  const pSel = document.getElementById('personFilter');
  ppl.forEach(p => { const o = document.createElement('option'); o.value=p; o.textContent=p; pSel.appendChild(o); });
}

// ‚îÄ‚îÄ TABLE ‚îÄ‚îÄ
let currentSort = { key: 'nextDue', asc: true };

function statusBadge(item) {
  if (item._urgency === 'overdue') return '<span class="badge badge-red">Overdue</span>';
  if (item.status === 'Not started') return '<span class="badge badge-purple">Not Started</span>';
  if (item.status.includes('Due Soon')) return '<span class="badge badge-orange">Due Soon</span>';
  return '<span class="badge badge-green">Up to Date</span>';
}

function reminderBadge(item) {
  if (item._days === Infinity || item._days < 0) return '';
  if (item._days <= 7) return '<div class="reminder-tag r7">üî¥ ÔøΩjÔøΩ 7 days</div>';
  if (item._days <= 14) return '<div class="reminder-tag r14">üü† ‚â§ 14 days</div>';
  if (item._days <= 30) return '<div class="reminder-tag r30">üü° ‚â§ 30 days</div>';
  return '';
}

function getFilteredItems() {
  const search = document.getElementById('searchInput').value.toLowerCase();
  const statusFilter = document.querySelector('.filter-btn.active')?.dataset.filter || 'all';
  const locFilter = document.getElementById('locationFilter').value;
  const entFilter = document.getElementById('entityFilter').value;
  const pFilter = document.getElementById('personFilter').value;

  return items.filter(i => {
    if (search && !(i.obligation+i.entity+i.category+i.person+i.location).toLowerCase().includes(search)) return false;
    if (locFilter !== 'all' && i.location !== locFilter) return false;
    if (entFilter !== 'all' && i.entity !== entFilter) return false;
    if (pFilter !== 'all' && !i.person.includes(pFilter)) return false;

    switch (statusFilter) {
      case 'overdue': return i._urgency === 'overdue';
      case 'due-7': return i._days >= 0 && i._days <= 7;
      case 'due-14': return i._days >= 0 && i._days <= 14;
      case 'due-30': return i._days >= 0 && i._days <= 30;
      case 'up-to-date': return i.status.includes('Up to date') && i._urgency === 'none';
      case 'not-started': return i.status === 'Not started';
      default: return true;
    }
  }).sort((a, b) => {
    let va, vb;
    switch (currentSort.key) {
      case 'nextDue': va = a._days; vb = b._days; break;
      case 'cost':
        va = parseFloat((a.cost||'0').replace(/[$,]/g,'')) || 0;
        vb = parseFloat((b.cost||'0').replace(/[$,]/g,'')) || 0;
        break;
      default: va = (a[currentSort.key]||'').toLowerCase(); vb = (b[currentSort.key]||'').toLowerCase();
    }
    if (va < vb) return currentSort.asc ? -1 : 1;
    if (va > vb) return currentSort.asc ? 1 : -1;
    return 0;
  });
}

function renderTable() {
  const filtered = getFilteredItems();
  const tbody = document.getElementById('tableBody');
  const noItems = document.getElementById('noItems');

  if (!filtered.length) {
    tbody.innerHTML = '';
    noItems.style.display = 'block';
    return;
  }
  noItems.style.display = 'none';

  tbody.innerHTML = filtered.map(i => `
    <tr>
      <td>${statusBadge(i)}</td>
      <td class="obligation-text">
        <div class="main">${i.obligation}</div>
        <div class="entity">${i.type} ¬∑ ${i.description || '‚Äî'}</div>
      </td>
      <td><span class="badge badge-blue">${i.category}</span></td>
      <td><span class="location-flag">${locationFlag(i.location)}</span>${i.location}</td>
      <td><strong>${i.entity}</strong></td>
      <td><span class="person">${i.person}</span></td>
      <td>${i.frequency}</td>
      <td style="white-space:nowrap;">
        ${formatDate(i.nextDue)}
        ${i._days !== Infinity && i._days >= 0 ? `<div style="font-size:.72rem;color:var(--text-secondary);">${i._days} day${i._days!==1?'s':''} left</div>` : ''}
        ${i._days < 0 ? `<div style="font-size:.72rem;color:var(--red);">${Math.abs(i._days)} days overdue</div>` : ''}
      </td>
      <td>${i.cost || '‚Äî'}</td>
      <td>${reminderBadge(i)}</td>
    </tr>
  `).join('');
}

// ‚îÄ‚îÄ REMINDER CARDS ‚îÄ‚îÄ
function renderReminders() {
  const upcoming = items
    .filter(i => i._days >= 0 && i._days <= 30)
    .sort((a,b) => a._days - b._days);

  const container = document.getElementById('reminderCards');

  if (!upcoming.length) {
    container.innerHTML = '<div class="no-items">No reminders due within the next 30 days.</div>';
    document.getElementById('emailPreview').style.display = 'none';
    return;
  }

  container.innerHTML = upcoming.map(i => {
    const dotClass = i._days <= 7 ? 'critical' : i._days <= 14 ? 'warning' : 'notice';
    const dueLabel = i._days === 0 ? 'Due today' : i._days === 1 ? 'Due tomorrow' : `Due in ${i._days} days`;
    return `
      <div class="reminder-card">
        <div class="urgency-dot ${dotClass}"></div>
        <div class="rc-content">
          <div class="rc-title">${i.obligation}</div>
          <div class="rc-meta">${i.entity} ¬∑ ${locationFlag(i.location)} ${i.location} ¬∑ ${i.person}</div>
          <div class="rc-due" style="color:${dotClass==='critical'?'var(--red)':dotClass==='warning'?'var(--orange)':'var(--yellow)'};">${dueLabel} ‚Äî ${formatDate(i.nextDue)}</div>
        </div>
      </div>
    `;
  }).join('');

  // Sample email preview
  const next = upcoming[0];
  const ep = document.getElementById('emailPreview');
  ep.style.display = 'block';
  ep.innerHTML = `
    <h4>üìß Sample Email Reminder</h4>
    <div class="email-field"><strong>To:</strong> brandon.cheema@nf6capital.com</div>
    <div class="email-field"><strong>Subject:</strong> ‚ö†Ô∏è Compliance Reminder: ${next.obligation} ‚Äî Due ${formatDate(next.nextDue)}</div>
    <div class="email-body">
      Hi Brandon,<br><br>
      This is a reminder that the following compliance item is due <strong>${next._days === 0 ? 'today' : 'in ' + next._days + ' days'}</strong>:<br><br>
      <strong>Obligation:</strong> ${next.obligation}<br>
      <strong>Entity:</strong> ${next.entity}<br>
      <strong>Location:</strong> ${locationFlag(next.location)} ${next.location}<br>
      <strong>Person Responsible:</strong> ${next.person}<br>
      <strong>Due Date:</strong> ${formatDate(next.nextDue)}<br>
      ${next.cost ? '<strong>Cost:</strong> ' + next.cost + '<br>' : ''}
      ${next.description ? '<strong>Notes:</strong> ' + next.description + '<br>' : ''}
      <br>
      Please take action to ensure this item is completed on time.<br><br>
      Best regards,<br>
      NF6 Capital Compliance System
    </div>
  `;
}

// ‚îÄ‚îÄ EVENT LISTENERS ‚îÄ‚îÄ
document.getElementById('todayBadge').textContent = TODAY.toLocaleDateString('en-US', { weekday:'short', month:'short', day:'numeric', year:'numeric' });

document.querySelectorAll('.filter-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    renderTable();
  });
});

document.getElementById('searchInput').addEventListener('input', renderTable);
document.getElementById('locationFilter').addEventListener('change', renderTable);
document.getElementById('entityFilter').addEventListener('change', renderTable);
document.getElementById('personFilter').addEventListener('change', renderTable);

document.querySelectorAll('th[data-sort]').forEach(th => {
  th.addEventListener('click', () => {
    const key = th.dataset.sort;
    if (currentSort.key === key) currentSort.asc = !currentSort.asc;
    else { currentSort.key = key; currentSort.asc = true; }
    renderTable();
  });
});

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
renderStats();
renderBanner();
populateDropdowns();
renderTable();
renderReminders();
</script>
</body>
</html>
